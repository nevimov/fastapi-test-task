!function(){"use strict";var e,t=function(){function e(e){this.jwt_token=e}var t=e.prototype;return t.get=function(e,t){return this._makeRequest("GET",e,t)},t.post=function(e,t){return this._makeRequest("POST",e,t)},t._makeRequest=function(e,t,a,i){var o={type:e,url:t,data:a,headers:{Authorization:"Bearer "+this.jwt_token},contentType:"application/json",dataType:"json"};return(i=i||function(e,t,a){0==e.readyState?n("Can't connect with the server. Please check your network connection or try again later."):e.readyState<4&&n("An unknown error occurred. Please try again later.")})&&(o.error=i),$.ajax(o)},e}();function n(e){a("alert-danger",e)}function a(e,t){var n='\n  <div class="alert '+e+' alert-dismissible top fade show" role="alert">\n    <div class="alert-content"> '+t+' </div>\n    <button type="button" class="close" data-dismiss="alert">\n      <span>&times;</span>\n    </button>\n  </div>\n  ';$("body").prepend(n)}function i(e){var t=$(e);t.find(".invalid-feedback").remove(),t.find(".is-invalid").removeClass("is-invalid")}e=window.urls,$("#login-form").on("submit",(function(t){if(t.preventDefault(),!1!==this.checkValidity()){var a=$(this),i=a.attr("action"),o=a.serialize();$.post(i,o).done((function(t){var n;n=t.access_token,window.localStorage.setItem("jwt_token",n),window.location.href=e.pages.MY_URLS})).fail((function(e,t,a){0==e.readyState?n("Can't connect with the server. Please check your network connection or try again later."):e.readyState<4?n("An unknown error occurred. Please try again later."):n(e.responseJSON.detail)}))}})),function(){var e=window.urls;if(window.location.href===e.pages.MY_URLS){var o=window.localStorage.getItem("jwt_token");o||window.location.replace(e.pages.LOGIN);var r=new t(o),s=$("#my-urls-table-spinner"),l=$("#my-urls-table tbody"),c=$("#my-urls-pagination");d(),$("#add-url-form").on("submit",(function(t){t.preventDefault();if(!1!==this.checkValidity()){var o=$(this),s=o.find('[name="destination"]').val(),l=o.find('[name="key"]').val(),c={destination:s};l&&(c.key=l),c=JSON.stringify(c);var u=r.post(e.api.ADD_URL,c);u.done((function(e,t,n){i(o),f(),d(),p(n);var r='<a href="'+e.destination+'">'+e.destination+"</a>",s=location.protocol+"//"+location.host+"/"+e.key;a("alert-success","Success! Created redirect from "+('<a href="'+s+'">'+s+"</a>")+" to "+r+".")})),u.fail((function(e,t,a){if(4===e.readyState){i(o);var r=e.responseJSON.detail;if("string"!=typeof r)for(var s=0;s<r.length;s++){var l=r[s],c=l.loc[1],d=o.find('[name="'+c+'"]');d.addClass("is-invalid"),d.parent().append('<div class="invalid-feedback">'+l.msg+"</div>")}else n(""+r)}}))}})),console.log("done")}function d(t,a){t=t||0,a=a||25,s.show();var i=r.get(e.api.GET_MY_URLS,{skip:t,limit:a});i.done((function(e,t,n){for(var a=e,i=0;i<a.length;i++){var o=a[i],r=location.protocol+"//"+location.host+"/"+o.key,s=o.destination;l.append("\n          <tr>\n            <td>"+(i+1)+'</td>\n            <td><a href="'+s+'">'+s+'</a></td>\n            <td><a href="'+r+'">/'+o.key+"</td>\n          </tr>\n        ")}p(n)})),i.fail((function(e,t,a){4===e.readyState&&n(e.responseJSON.detail)})),i.always((function(e,t){s.hide()}))}function f(){l.empty()}function u(e){f(),d(e.data.skip,25)}function p(e){c.empty();for(var t=e.getResponseHeader("X-User-Url-Count"),n=Math.ceil(t/25),a=1;a<=n;a++){var i=$('<li class="page-item"> <a href="#!" class="page-link">'+a+"</a> </li>");i.on("click",{skip:25*(a-1)},u),c.append(i)}}}()}();
//# sourceMappingURL=main.js.map
